# ========================
# PUERTO PARA RENDER
# ========================
# ✅ Render usa variable PORT
server.port=${PORT:8080}  

# ========================
# BASE DE DATOS - RENDER (CORREGIDO)
# ========================
# ❌ ERROR: URL incorrecta - Falta el puerto y formato incorrecto
# ✅ CORREGIDO:
#spring.datasource.url=jdbc:postgresql://dpg-d5e50g9r0fns73a0n6p0-a.oregon-postgres.render.com:5432/tiendagestor?sslmode=require&ssl=true
#spring.datasource.username=tiendagestor_user
#spring.datasource.password=YQe76PR2ts7dAxAfQXmCfq34Y4jDHIg6
spring.datasource.driver-class-name=org.postgresql.Driver

# ========================
# CONFIGURACIÓN SSL PARA RENDER (CRÍTICO)
# ========================
spring.datasource.hikari.data-source-properties.sslmode=require
spring.datasource.hikari.data-source-properties.ssl=true
spring.datasource.hikari.data-source-properties.sslfactory=org.postgresql.ssl.NonValidatingFactory

# ========================
# POOL DE CONEXIONES
# ========================
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ========================
# JPA / HIBERNATE
# ========================
# ✅ Para desarrollo, usa 'update' para crear tablas automáticamente
spring.jpa.hibernate.ddl-auto=update 
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Deshabilitar validación de conexión inicial
spring.datasource.hikari.initialization-fail-timeout=0

# ========================
# SERVIDOR
# ========================
server.address=0.0.0.0  
# Aceptar conexiones de cualquier IP

# ========================
# ARCHIVOS ESTÁTICOS
# ========================
spring.web.resources.static-locations=classpath:/static/
spring.mvc.static-path-pattern=/**

# ========================
# LOGGING PARA DEBUG
# ========================
logging.level.com.tienda=DEBUG
logging.level.org.springframework=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type=TRACE
logging.level.com.zaxxer.hikari=DEBUG

# Mostrar errores completos
server.error.include-stacktrace=always
server.error.include-message=always
server.error.include-binding-errors=always

# ========================
# CORS (IMPORTANTE)
# ========================
cors.allowed-origins=*
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true